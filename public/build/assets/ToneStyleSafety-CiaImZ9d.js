import{a as _,r as o,j as e,u as w,H as S}from"./app-Bmu8w64d.js";const C=_.create({baseURL:"/api/v1",withCredentials:!0,headers:{Accept:"application/json"}});async function k(){const{data:i}=await C.get("/me");return i}function A(){const[i,t]=o.useState(null),[a,d]=o.useState(!0),[c,m]=o.useState(null);return o.useEffect(()=>{let n=!0;return(async()=>{try{const l=await k();if(!n)return;l.ok?t(l.user??null):m("Failed to load user.")}catch(l){if(!n)return;m((l==null?void 0:l.message)??"Failed to load user.")}finally{n&&d(!1)}})(),()=>{n=!1}},[]),{user:i,loading:a,error:c}}function T({children:i}){var c;const{user:t,loading:a,error:d}=A();return a?e.jsx("div",{className:"p-6",children:"Loading..."}):d?e.jsxs("div",{className:"p-6 text-red-600",children:["Auth error: ",d]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("header",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("div",{className:"font-semibold",children:"GarageCRM"}),e.jsx("div",{className:"text-sm",children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:t.name}),((c=t.company)==null?void 0:c.name)&&e.jsx("span",{className:"opacity-70",children:t.company.name})]}):e.jsx("span",{className:"opacity-70",children:"Not signed in"})})]}),e.jsx("main",{className:"p-6",children:i})]})}function R({config:i}){var x,h;const{data:t,setData:a,post:d,processing:c,recentlySuccessful:m}=w(i),[n,l]=o.useState(""),[p,u]=o.useState(""),f=()=>{n.trim()&&(a("stop_words",[...t.stop_words||[],n.trim()]),l(""))},g=s=>{const r=[...t.stop_words];r.splice(s,1),a("stop_words",r)},j=()=>{p.trim()&&(a("forbidden_topics",[...t.forbidden_topics||[],p.trim()]),u(""))},b=s=>{const r=[...t.forbidden_topics];r.splice(s,1),a("forbidden_topics",r)},y=s=>{s.preventDefault(),d(route("admin.ai.tone.save"))},v="hey can you pick up my car and also what’s the price?",N=(()=>{let s=v;t.tone_preset==="professional"&&(s=s.replace(/^hey/i,"Hello")),t.tone_preset==="friendly"&&(s=s.replace(/^hey/i,"Hi"));const r=Number(t.reply_length_limit||480);return t.truncate_over_limit&&s.length>r&&(s=s.slice(0,r-1)+"…"),s})();return e.jsxs(T,{children:[e.jsx(S,{title:"AI — Tone, Style & Safety"}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Tone, Style & Safety"}),e.jsxs("form",{onSubmit:y,className:"space-y-6 bg-white p-6 rounded-xl shadow",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-medium",children:"Tone preset"}),e.jsx("div",{className:"mt-2 flex gap-4",children:["friendly","professional","custom"].map(s=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"tone",checked:t.tone_preset===s,onChange:()=>a("tone_preset",s)}),e.jsx("span",{className:"capitalize",children:s})]},s))}),t.tone_preset==="custom"&&e.jsx("textarea",{className:"mt-3 w-full border rounded p-2",rows:4,placeholder:"Write custom style guidelines…",value:t.custom_style_guidelines||"",onChange:s=>a("custom_style_guidelines",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-medium",children:"Reply length limit (chars)"}),e.jsx("input",{type:"number",className:"mt-2 w-full border rounded p-2",min:100,max:2e3,value:t.reply_length_limit,onChange:s=>a("reply_length_limit",Number(s.target.value))}),e.jsxs("label",{className:"mt-3 flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!t.truncate_over_limit,onChange:s=>a("truncate_over_limit",s.target.checked)}),"Truncate if over limit"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-medium",children:"Rate limits"}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Per minute"}),e.jsx("input",{type:"number",className:"w-full border rounded p-2",min:1,max:120,value:(x=t.rate_limit)==null?void 0:x.per_minute,onChange:s=>a("rate_limit",{...t.rate_limit,per_minute:Number(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Burst"}),e.jsx("input",{type:"number",className:"w-full border rounded p-2",min:1,max:240,value:(h=t.rate_limit)==null?void 0:h.burst,onChange:s=>a("rate_limit",{...t.rate_limit,burst:Number(s.target.value)})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-medium",children:"Stop words"}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("input",{className:"flex-1 border rounded p-2",placeholder:"Add a stop word e.g., STOP",value:n,onChange:s=>l(s.target.value)}),e.jsx("button",{type:"button",className:"px-3 py-2 bg-gray-900 text-white rounded",onClick:f,children:"Add"})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(t.stop_words||[]).map((s,r)=>e.jsxs("span",{className:"px-2 py-1 bg-gray-100 rounded text-sm",children:[s," ",e.jsx("button",{type:"button",className:"ml-1 text-gray-500",onClick:()=>g(r),children:"×"})]},r))}),e.jsxs("label",{className:"mt-4 flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!t.handoff_on_stop_word,onChange:s=>a("handoff_on_stop_word",s.target.checked)}),"Auto-handoff when a stop word appears"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-medium",children:"Forbidden topics"}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("input",{className:"flex-1 border rounded p-2",placeholder:"Add a forbidden topic",value:p,onChange:s=>u(s.target.value)}),e.jsx("button",{type:"button",className:"px-3 py-2 bg-gray-900 text-white rounded",onClick:j,children:"Add"})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(t.forbidden_topics||[]).map((s,r)=>e.jsxs("span",{className:"px-2 py-1 bg-gray-100 rounded text-sm",children:[s," ",e.jsx("button",{type:"button",className:"ml-1 text-gray-500",onClick:()=>b(r),children:"×"})]},r))}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-medium",children:"Safety mode"}),e.jsxs("select",{className:"mt-2 w-full border rounded p-2",value:t.safe_mode,onChange:s=>a("safe_mode",s.target.value),children:[e.jsx("option",{value:"off",children:"Off"}),e.jsx("option",{value:"soft",children:"Soft"}),e.jsx("option",{value:"strict",children:"Strict"})]})]})]})]}),e.jsxs("div",{className:"border rounded p-4 bg-gray-50",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Preview (local)"}),e.jsx("div",{className:"p-3 bg-white rounded border",children:N})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-gray-900 text-white rounded",children:"Save"}),m&&e.jsx("span",{className:"text-green-600 text-sm",children:"Saved ✓"})]})]})]})]})}export{R as default};
