import{j as e,r as x}from"./app-Bmu8w64d.js";function o(s,r){if(!s)return"";let t=s;return t=t.replace(/\{\{\s*([^}]+?)\s*\}\}|\{([^}]+?)\}/g,(n,i,d)=>{const l=(i||d||"").trim();return l&&r&&!Array.isArray(r)&&typeof r=="object"?r[l]??"":""}),Array.isArray(r)&&(t=t.replace(/\{(\d+)\}/g,(n,i)=>{const d=parseInt(i,10)-1;return r[d]??""})),t}const g=({children:s})=>e.jsx("div",{className:"max-w-[85%] rounded-2xl px-3 py-2 bg-[#DCF8C6] text-black shadow-sm",children:e.jsx("div",{className:"whitespace-pre-wrap text-[15px] leading-snug",children:s})}),h=({text:s})=>s?e.jsx("div",{className:"mt-2 text-[12px] text-gray-500",children:s}):null,j=({buttons:s=[]})=>s!=null&&s.length?e.jsx("div",{className:"mt-3 flex flex-col gap-2",children:s.map((r,t)=>e.jsx("button",{type:"button",className:"text-left w-full border rounded-xl px-3 py-2 text-[14px] hover:bg-gray-50",onClick:n=>n.preventDefault(),title:r.type,children:r.text},t))}):null;function f({template:s,variables:r,meta:t={}}){const n=o(s==null?void 0:s.header,r),i=o(s==null?void 0:s.body,r),d=o(s==null?void 0:s.footer,r),l=t.timeString||"10:22 AM";return e.jsxs("div",{className:"bg-[#ECE5DD] p-4 rounded-2xl border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold",children:"Customer"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"online"})]})]}),e.jsx("div",{className:"bg-[#E5DDD5] rounded-xl p-3 min-h-[220px] flex flex-col gap-2",children:e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{children:[e.jsxs(g,{children:[n&&e.jsx("div",{className:"font-semibold mb-1",children:n}),i,e.jsx("div",{className:"mt-1 text-[11px] text-gray-500 text-right",children:l})]}),e.jsx(h,{text:d}),e.jsx(j,{buttons:s==null?void 0:s.buttons})]})})})]})}function p({template:s,payload:r}){const[t,n]=x.useState(JSON.stringify(r??{},null,2)),[i,d]=x.useState(""),l=x.useMemo(()=>{try{return d(""),t.trim()?JSON.parse(t):{}}catch(c){return d(c.message),{}}},[t]);return e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"WhatsApp Template Preview"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow p-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Template"}),e.jsxs("div",{className:"font-medium",children:[s.name," (",s.language,")"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Provider: ",s.provider," â€¢ Code: ",s.provider_template]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Variables JSON"}),e.jsx("textarea",{className:"mt-1 w-full border rounded-xl p-3 font-mono text-sm h-56",value:t,onChange:c=>n(c.target.value),spellCheck:!1}),i&&e.jsx("div",{className:"mt-1 text-xs text-red-600",children:i}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>n(JSON.stringify(r??{},null,2)),className:"px-3 py-2 rounded-lg bg-gray-900 text-white text-sm",children:"Reset to example"}),e.jsx("button",{onClick:()=>{var m;const c=((m=(s.body||"").match(/\{\{\s*([^}]+)\s*\}\}/g))==null?void 0:m.map(a=>a.replace(/[{}]/g,"").trim()))||[],u=Object.fromEntries(c.map(a=>[a.replace(/^\s*|\s*$/g,""),""]));n(JSON.stringify(u,null,2))},className:"px-3 py-2 rounded-lg bg-gray-200 text-sm",children:"Extract keys"})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow p-4",children:e.jsx(f,{template:s,variables:l,meta:{timeString:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}})})]})]})}export{p as default};
